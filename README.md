
# WPA2 with Decentralized Authentication servers

Goal: 

Implement WPA2 using decentralized Authentication with using blockchain to store user credentials.


Objectives: 

to implement WPA2 with AS server to authenticate users and provides tokens with validity which are used between user and access point over the wireless network.
The tokens generated by AS can be used by client to connect any AP.
Blockchain technology will be used to maintain identical user credentials among servers to overcome single point of failure.


## Authenticating Server: 
AS will add client(user) to the blockchain. AS will generate a per user key(password) then share it to user &  store it on blockchain. 
C –> AS:		ID || E[PSK(C), ID, nonce, mode, Validity]
Client request for authentication at server, mode(H: hours, D: day)

User can be authenticated at AS by ID & password (secret key), after which AS will generate token for client.
AS –> C:		ID || E[PSK(C), SK || ID || nonce || Token] || Token
Token : 			E[PSK(AP), (SK || ID || ExpiryTime)]
SK(session key can used between AP & client to share data confidentially)

At AP user can be authenticated using token(certificate).


## AP: 
At AP user can be authenticated using token(certificate). If the token is valid the connection is accepted.
C –> AP:		ID ||  Token
If the ID outside token & ID inside token matches & token is not expired then connection is approved.

AP can obtain the session key (SK) from token.
SK(session key can used between AP & client to share data confidentially)

## Client(STA):

If client has a token it will try to get authenticated by token.
If token verification fails then, user will be verified by ID & PSK(client).




### Running Code

To run code, install a python3 and then run the following command,
First install the dependency. 
```bash
  pip install -r requirements.txt
```

## For blockchain
Now, run minner.py,

First run the script minner.py 
```bash
python3 minner.py -p minner_port
```
. -p for port number

. By running minner.py script, it will wait till it get data from two servers.

. Then create a block and send it to the servers.
## Note
. Run two servers(AS.py) in order to create a blockchain.

. run the server AS.py script.
Now, run AS.py as Authenticating Server,
```bash
  python3 ./AS.py -n N -p port -m MinnerPort
```
for windows,

```bash
  python ./AS.py -n N -p port -m MinnerPort
```
• N: specifies name for server (int)

• port: specifies port for server

• MinnerPort:  MinnerPort port for server


Now, run AP.py as Access Point,
```bash
  python3 AP.py -n AccessPoint -a ip -p port

```
for windows,

```bash
  python AP.py -n AccessPoint -a ip -p port
```
• n: specifies name for Access point

• port: specifies port for server

• ip:  ip address for server


Now, STA as client,
```bash
  python3 STA.py -n Username -a AP_name -m H -v T

```
for windows,

```bash
  python STA.py -n Username -a AP_name -m H -v T
```
• n: specifies Username

• a: AP name to be connected

• m: mode of validity of token H(hours) or D(day)

• v: v times validity of m (mode)

## Note:

if user (STA.py) is unable to connnect to AP try deleting AP.txt file 





```bash
python3 AS.py -n 1 -p 5008 -m 5050
```
. -n is for identifying the server. Its like server number.

. -m is for port used in the minner. Used to communicate with the minner

. use the same -p, -m in the execution.

. change the n values for each server, Its used for identifying the file used to store the blockchain.
